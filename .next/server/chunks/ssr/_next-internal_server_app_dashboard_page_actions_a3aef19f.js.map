{"version":3,"sources":["../../../../lib/actions/customers.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { createClient } from \"@/lib/supabase/server\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport { z } from \"zod\"\r\n\r\nconst customerSchema = z.object({\r\n  name: z.string().min(1, \"Name is required\"),\r\n  email: z.string().email(\"Invalid email address\").optional().nullable(),\r\n})\r\n\r\ntype CustomerInput = z.infer<typeof customerSchema>\r\n\r\n/**\r\n * Create a new customer\r\n */\r\nexport async function createCustomer(input: CustomerInput) {\r\n  try {\r\n    const validated = customerSchema.parse(input)\r\n    const supabase = await createClient()\r\n\r\n    const { data, error } = await supabase.from(\"customers\").insert([validated]).select().single()\r\n\r\n    if (error) throw new Error(error.message)\r\n\r\n    revalidatePath(\"/dashboard\")\r\n    return { success: true, data }\r\n  } catch (error) {\r\n    const message = error instanceof Error ? error.message : \"Failed to create customer\"\r\n    console.error(\"Create customer error:\", error)\r\n    return { success: false, error: message }\r\n  }\r\n}\r\n\r\n/**\r\n * Update an existing customer\r\n */\r\nexport async function updateCustomer(id: string, input: Partial<CustomerInput>) {\r\n  try {\r\n    const validated = customerSchema.partial().parse(input)\r\n    const supabase = await createClient()\r\n\r\n    const { data, error } = await supabase\r\n      .from(\"customers\")\r\n      .update({ ...validated, updated_at: new Date().toISOString() })\r\n      .eq(\"id\", id)\r\n      .select()\r\n      .single()\r\n\r\n    if (error) throw new Error(error.message)\r\n\r\n    revalidatePath(\"/dashboard\")\r\n    return { success: true, data }\r\n  } catch (error) {\r\n    const message = error instanceof Error ? error.message : \"Failed to update customer\"\r\n    console.error(\"Update customer error:\", error)\r\n    return { success: false, error: message }\r\n  }\r\n}\r\n\r\n/**\r\n * Delete a customer\r\n */\r\nexport async function deleteCustomer(id: string) {\r\n  try {\r\n    const supabase = await createClient()\r\n\r\n    const { error } = await supabase.from(\"customers\").delete().eq(\"id\", id)\r\n\r\n    if (error) throw new Error(error.message)\r\n\r\n    revalidatePath(\"/dashboard\")\r\n    return { success: true }\r\n  } catch (error) {\r\n    const message = error instanceof Error ? error.message : \"Failed to delete customer\"\r\n    console.error(\"Delete customer error:\", error)\r\n    return { success: false, error: message }\r\n  }\r\n}\r\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,oBAEA,IAAM,EAAiB,EAAA,CAAC,CAAC,MAAM,CAAC,CAC9B,KAAM,EAAA,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,EAAG,oBACxB,MAAO,EAAA,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC,yBAAyB,QAAQ,GAAG,QAAQ,EACtE,GAOO,eAAe,EAAe,CAAoB,EACvD,GAAI,CACF,IAAM,EAAY,EAAe,KAAK,CAAC,GACjC,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAE7B,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,aAAa,MAAM,CAAC,CAAC,EAAU,EAAE,MAAM,GAAG,MAAM,GAE5F,GAAI,EAAO,MAAM,AAAI,MAAM,EAAM,OAAO,EAGxC,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACR,CAAE,QAAS,GAAM,MAAK,CAC/B,CAAE,MAAO,EAAO,CACd,IAAM,EAAU,aAAiB,MAAQ,EAAM,OAAO,CAAG,4BAEzD,OADA,QAAQ,KAAK,CAAC,yBAA0B,GACjC,CAAE,SAAS,EAAO,MAAO,CAAQ,CAC1C,CACF,CAKO,eAAe,EAAe,CAAU,CAAE,CAA6B,EAC5E,GAAI,CACF,IAAM,EAAY,EAAe,OAAO,GAAG,KAAK,CAAC,GAC3C,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAE7B,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,aACL,MAAM,CAAC,CAAE,GAAG,CAAS,CAAE,WAAY,IAAI,OAAO,WAAW,EAAG,GAC5D,EAAE,CAAC,KAAM,GACT,MAAM,GACN,MAAM,GAET,GAAI,EAAO,MAAU,AAAJ,MAAU,EAAM,OAAO,EAGxC,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACR,CAAE,SAAS,OAAM,CAAK,CAC/B,CAAE,MAAO,EAAO,CACd,IAAM,EAAU,aAAiB,MAAQ,EAAM,OAAO,CAAG,4BAEzD,OADA,QAAQ,KAAK,CAAC,yBAA0B,GACjC,CAAE,SAAS,EAAO,MAAO,CAAQ,CAC1C,CACF,CAKO,eAAe,EAAe,CAAU,EAC7C,GAAI,CACF,IAAM,EAAW,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,IAE7B,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,aAAa,MAAM,GAAG,EAAE,CAAC,KAAM,GAErE,GAAI,EAAO,MAAM,AAAI,MAAM,EAAM,OAAO,EAGxC,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,cACR,CAAE,SAAS,CAAK,CACzB,CAAE,MAAO,EAAO,CACd,IAAM,EAAU,aAAiB,MAAQ,EAAM,OAAO,CAAG,4BAEzD,OADA,QAAQ,KAAK,CAAC,yBAA0B,GACjC,CAAE,SAAS,EAAO,MAAO,CAAQ,CAC1C,CACF,iCA9DsB,EAqBA,EA0BA,IA/CA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA0BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA"}